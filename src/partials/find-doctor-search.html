<div class="find-doctor-search-container find-doctor-search" ng-click="detectClickElement($event)"
  ng-init="onloadZipCodeValidation()">
  <list-messaging ng-bind='findDoctorSearchDetails.endOfYearMessage'
    ng-if="findDoctorSearchDetails.displayEndOfYearMessage"></list-messaging>
  <list-messaging class="no-plan-found-message" ng-bind='findDoctorSearchDetails.noMatchPlanFoundMessage'
    ng-if="nomatchPlan"></list-messaging>
  <list-messaging
    ng-if="loggedIn && (!findDoctorSearchDetails.policy.selectedPolicy.active || findDoctorSearchDetails.policy.future)"
    ng-bind="::loc.RESTRICT_ACCESS"></list-messaging>
  <list-messaging ng-bind='findDoctorSearchDetails.message' ng-if="findDoctorSearchDetails.message"></list-messaging>
  <div ng-if="(!loggedIn || (loggedIn && findDoctorSearchDetails.policy.selectedPolicy.active))">
    <div class="list-messaging" ng-if="loggedIn && !nomatchPlan">
      <span ng-bind="loc.FIND_CARE_MESSAGE_BDC_1"></span><span class="external-link"
        ng-bind="loc.FIND_CARE_MESSAGE_BDC_2" ng-click="gotoBrowseLevelPage(bdcLink, '', '', true)"></span> <i
        class="fc-external-link"></i><span ng-bind="loc.FIND_CARE_MESSAGE_BDC_3"></span>
    </div>
    <div class="search-box" ng-if="!hideSearchSettings">
      <div class="bg-white pb2 border-radius-top">
        <h5 class="search-header pl4 pt4" ng-bind="findDoctorSearchDetails.searchHeader"></h5>
        <div class="search-input">
          <form name="searchForm">
            <div class="input-group" id="top">
              <input type="text" class="form-control" ng-click="gotoAnchor('top')" ng-model="query" placeholder="Search"
                ng-model-options="{debounce: 800}" ng-focus="toggleQueryHasFocus(true)" ng-change="displayFlyout(query)"
                ng-keypress="refineSearchClick($event, query)">
            </div>
          </form>
          <i class="search-input-icon search-input-background fc-search fc-lg2 fc-underlay"
            ng-click="focusOnSearchInput()"></i>
          <i class="search-input-clear search-input-background fc-clear fc-ml" ng-show="query"
            ng-click="clearQueryAndTypeaheadResults()"></i>
        </div>
      </div>
      <div class="type-ahead-results-container" ng-show="queryHasFocus">
        <div ng-show="query && typeaheadResults" class="row m0">
          <p class="col-xs-10 col-xs-offset-1 typeahead-no-search-results-found mt2"
            ng-show="!typeaheadResults.search_specialties.length && !typeaheadResults.providers.length && !typeaheadResults.procedures.length && !typeaheadInProgress"
            ng-bind="::loc.UNAUTHENTICATED_NO_RESULTS_LINE_1"></p>
          <p class="col-xs-10 col-xs-offset-1 typeahead-no-search-results-found"
            ng-show="!typeaheadResults.search_specialties.length && !typeaheadResults.providers.length && !typeaheadResults.procedures.length && !typeaheadInProgress"
            ng-bind="::loc.UNAUTHENTICATED_NO_RESULTS_LINE_2"></p>
        </div>
        <div ng-show="query && typeaheadInProgress" class="row m0 mb2 text-center flex-center-center">
          <i class="fa fa-spinner fa-2x fa-rotate mr1"></i>
          <span class="mt-1" ng-bind="::loc.BP_LOADING"></span>
          &nbsp;
          <span class="mt-1" ng-bind="::loc.RESULTS"></span>
        </div>
        <!-- Type Ahead technical error -->
        <div ng-show="query && typeaheadError">
          <h5 class="type-ahead-error pl4 pt2 pb4" ng-bind="::loc.TYPE_AHEAD_ERROR"></h5>
        </div>
        <!-- Common Searches -->
        <div
          ng-show="!typeaheadError && ((query && (!typeaheadResults.search_specialties.length && !typeaheadResults.providers.length && !typeaheadResults.procedures.length && !typeaheadInProgress)) || (!query && queryHasFocus))"
          class="univers bold-text bg-white pb1">
          <hr ng-if="anyCommonTerms()" />
          <div class="type-ahead-title" ng-if="anyCommonTerms()" ng-bind="findDoctorSearchDetails.commonSearches"></div>
          <div ng-hide="expandCommonDiv" ng-repeat="commonSearch in findDoctorSearchDetails.commonSearchTerms">
            <div class="customer-item" ng-repeat="row in commonSearch" ng-if="$index < 3">
              <div ng-click="goToCommonDetails(row)">
                <hr />
                <div class="type-ahead-subtitle" ng-bind="row.commonSearchTerm"></div>
              </div>
            </div>
          </div>
          <div ng-hide="!expandCommonDiv" ng-repeat="commonSearch in findDoctorSearchDetails.commonSearchTerms">
            <div class="customer-item" ng-repeat="row in commonSearch">
              <div ng-click="goToCommonDetails(row)">
                <hr />
                <div class="type-ahead-subtitle" ng-bind="row.commonSearchTerm"></div>
              </div>
            </div>
          </div>
          <hr ng-if="anyCommonTerms()" />
          <div class="type-ahead-subtitle" ng-if="moreCommonTerms()" ng-click="expandCommonTerms()">
            <i class="text-center"
              ng-class="{'fc-plus-expand': !expandCommonDiv, 'fc-minus-collapse': expandCommonDiv}"></i>
            <span class="text-left" ng-if="!expandCommonDiv" ng-bind="findDoctorSearchDetails.seeMoreCommon"></span>
            <span class="text-left" ng-if="expandCommonDiv"
              ng-bind="findDoctorSearchDetails.seeLessCommon"></span>&nbsp;
          </div>
        </div>
        <!-- End Common Searches -->
        <div
          ng-show="query && (typeaheadResults.providers.length || typeaheadResults.search_specialties.length || typeaheadResults.procedures.length)"
          class="univers-cn bg-white">
          <hr ng-show="typeaheadResults.providers.length" class="m0" />
          <div ng-show="typeaheadResults.providers.length">
            <div class="mt2 mb1 type-ahead-title" ng-bind="findDoctorSearchDetails.peoplePlaces"></div>
            <hr class="m0" />
            <div class="customer-item" ng-repeat="result in typeaheadResults.providers | limitTo: 3">
              <div class="mt2 mb1 type-ahead-subtitle" ng-bind="result.name" ng-click="goToDetails(result)"></div>
              <div class="mb1 type-ahead-summary" ng-bind="result.specialty"></div>
              <hr class="m0" />
            </div>
            <div class="mt2 mb1 med-blue pl4">
              &quot;<span class="text-left" ng-bind="query" ng-click="goToDetails(query)"></span>&quot;
            </div>
          </div>

          <div ng-show="typeaheadResults.search_specialties.length">
            <hr class="m0" />
            <div id="search_specialties"
              ng-class="{'bg-beige':highlightTextSpecialists, 'bg-white':!highlightTextSpecialists}">
              <div class="pt2 pb1 type-ahead-title" ng-bind="findDoctorSearchDetails.specialistsWho"></div>
            </div>
            <div ng-hide="expandSpecialtiesDiv" class="customer-item"
              ng-repeat="result in typeaheadResults.search_specialties | limitTo: 3">
              <hr class="m0" />
              <div class="mt2 mb1 type-ahead-subtitle" ng-bind="result.name" ng-click="goToDetails(result)"></div>
              <div class="mb1 type-ahead-summary" ng-bind="result.description[language]"></div>
            </div>
            <div ng-hide="!expandSpecialtiesDiv" class="customer-item"
              ng-repeat="result in typeaheadResults.search_specialties">
              <hr />
              <div class="mt2 mb1 type-ahead-subtitle" ng-bind="result.name" ng-click="goToDetails(result)"></div>
              <div class="mb1 type-ahead-summary" ng-bind="result.description[language]"></div>
            </div>
            <hr ng-show="typeaheadResults.search_specialties.length > 3" class="m0" />
            <div class="mt2 mb1 type-ahead-subtitle" ng-show="typeaheadResults.search_specialties.length > 3"
              ng-click="expandSpecialties()">
              <i class="text-center"
                ng-class="{'fc-plus-expand': !expandSpecialtiesDiv, 'fc-minus-collapse': expandSpecialtiesDiv}"></i>
              <span class="text-left" ng-if="!expandSpecialtiesDiv"
                ng-bind="findDoctorSearchDetails.moreSpecialties"></span>&nbsp;
              <span class="text-left" ng-if="expandSpecialtiesDiv"
                ng-bind="findDoctorSearchDetails.lessSpecialties"></span>&nbsp;
              &quot;<span class="text-left" ng-bind="query"></span>&quot;
            </div>
          </div>

          <!-- Do no display if unauthenticated -->
          <div id="procedures" ng-if="loggedIn && !medicareUser && typeaheadResults.procedures.length"
            ng-class="{'bg-beige':highlightTextProcedures, 'bg-white':!highlightTextProcedures}">
            <hr class="m0" />
            <div class="pt2 pb1 type-ahead-title" ng-bind="findDoctorSearchDetails.providersPerform"></div>
          </div>
          <hr ng-show="loggedIn && !medicareUser && typeaheadResults.procedures.length" class="m0" />
          <div ng-hide="expandProceduresDiv" class="customer-item"
            ng-repeat="result in typeaheadResults.procedures | limitTo: 3" ng-if="!medicareUser">
            <div class="mt2 mb1 type-ahead-subtitle" ng-bind="result.locale_name" ng-click="goToDetails(result)"></div>
            <div class="mb1 type-ahead-summary" ng-bind="result.description"></div>
            <hr class="m0" />
          </div>
          <div ng-hide="!expandProceduresDiv" class="customer-item" ng-repeat="result in typeaheadResults.procedures"
            ng-if="!medicareUser">
            <div class="mt2 mb1 type-ahead-subtitle" ng-bind="result.locale_name" ng-click="goToDetails(result)"></div>
            <div class="mb1 type-ahead-summary" ng-bind="result.description"></div>
            <hr class="m0" />
          </div>
          <div class="mt2 mb1 type-ahead-subtitle" ng-show="typeaheadResults.procedures.length > 3"
            ng-click="expandProcedures()" ng-if="!medicareUser">
            <i class="text-center"
              ng-class="{'fc-plus-expand': !expandProceduresDiv, 'fc-minus-collapse': expandProceduresDiv}"></i>
            <span class="text-left" ng-if="!expandProceduresDiv"
              ng-bind="findDoctorSearchDetails.moreProcedures"></span>&nbsp;
            <span class="text-left" ng-if="expandProceduresDiv"
              ng-bind="findDoctorSearchDetails.lessProcedures"></span>&nbsp;
            &quot;<span class="text-left" ng-bind="query"></span>&quot;
          </div>
        </div>
      </div>

      <div ng-hide="typeaheadInProgress || typeaheadError" class="flex-row univers-cn bg-lightest-gray pt2 pb2"
        ng-class="{'border-radius-bottom': !expandDiv}" ng-click="expandSettings()">
        <!-- search setting div-->
        <i class="col-xs-2 text-center pl3 heading-icon fc-settings-nocircle fc-med med-blue"></i>
        <span class="col-xs-8 text-left med-blue" ng-bind="findDoctorSearchDetails.searchSettings"></span>
        <i class="col-xs-2 pt1 text-center"
          ng-class="{'fc-plus-expand': !expandDiv, 'fc-minus-collapse': expandDiv}"></i>
      </div> <!-- end of search setting -->
      <div ng-class="{'search-settings-close-div': !expandDiv, 'search-settings-open-div': expandDiv}">
        <div class="error-text" ng-bind="errorText" ng-show="isZipDirty && !isZipValid"></div>
        <div class="search-settings-container">
          <div class="search-settings-member-dropdown search-box-settings" ng-if="loggedIn && !nomatchPlan">
            <div class="search-settings-input-label-member">
              <label ng-bind="loc.MEMBER"></label>
            </div>
            <div class="search-settings-input-box">
              <div class="search-settings-down-arrow"><i class="fa fc-dropdown"></i></div>
              <select class="select-member" ng-model="selectedMember" ng-change="selectPolicyMember(selectedMember)"
                ng-options="member as (member.givenName + ' ' + member.familyName) for member in policyMembersList">
              </select>
            </div>
          </div>
          <!-- search setting open and close div-->
          <div class="search-box-settings search-box-settings-width">
            <div class="search-settings-input-label">
              <label ng-bind="loc.DISTANCE"></label>
            </div>
            <div class="search-settings-input-box">
              <div class="search-settings-down-arrow"><i class="fa fc-dropdown"></i></div>
              <select class="select-distance filter-select" ng-model="data.displayDistance" ng-blur="saveDistance()"
                ng-options="item + ' ' + loc.MILES for item in findDoctorSearchDetails.distanceDetails.distance_options">
              </select>
            </div>
          </div>
          <div class="search-box-settings search-box-settings-width">
            <div class="search-settings-input-label">
              <label ng-bind="loc.FROM_CITY_COUNTY_OR_ZIP_CODE"></label>
            </div>
            <div class="search-settings-zipcode" ng-class="{'error-input': isZipDirty && !isZipValid}">
              <lookup-cities-input city="data.city" class="lookup-cities-input" ng-click="enableInputZipCode()">
              </lookup-cities-input>
              <div class="location-icon" ng-click="toggleCurrentLocation()">
                <i ng-if="currentLocationActive===true && currentLocation===true"
                  class="fa fc-current-location-active"></i>
                <i ng-if="(currentLocationActive===true && currentLocation===false) || (currentLocationActive===false && locationBlocked===false)"
                  class="fa fc-current-location-outline"></i>
              </div>
            </div>
          </div>
        </div> <!-- end of search setting when open and close div-->
        <div class="border-radius-bottom"><label class="greyBlockedMsg" ng-bind="locationMsg"
            ng-if="locationBlocked"></label></div>
      </div>
    </div>
    <div class="link-row" ng-if="!findDoctorSearchDetails.message" ng-click="toggleQueryHasFocus(false)">
      <div class="heading-description" ng-bind='findDoctorSearchDetails.heading'></div>
      <hr />
      <div class="icon-container"
        ng-class="{'has-1-item': findDoctorSearchDetails.links.length === 1, 'has-2-items': findDoctorSearchDetails.links.length === 2}">
        <div class="link-item" ng-repeat="link in findDoctorSearchDetails.links">
          <div class="url-link"
            ng-click="gotoBrowseLevelPage(link.linkContent.url, link.description, findDoctorSearchDetails.searchParams, link.linkContent.externalUrl)"
            ng-if="!findDoctorSearchDetails.blockSearchBoxForRxPdpPlan">
            <i class="{{link.icon}} fc-xl"></i>
            <div class="icon-text-description" ng-bind="link.description"></div>
          </div>
          <div class="url-link" ng-click="openInSecureBrowser(link.linkContent.url)"
            ng-if="findDoctorSearchDetails.blockSearchBoxForRxPdpPlan">
            <i class="{{link.icon}} fc-xl"></i>
            <div class="icon-text-description" ng-bind="link.description"></div>
          </div>
        </div>
      </div>
      <hr class="divider" ng-if="isSmartShopperEligible" />
      <div class="small-padding text-center" ng-if="isSmartShopperEligible">
        <button class="btn btn-default btn-block smart-shopper-btn"
          ng-click="openTermsModal(); $event.stopPropagation()"
          track-action="{action: 'healthNavSmartShopperButton', section: analyticConstants.HEALTHNAV_SECTION}">
          <i class="fc-smartshopper-outline fc-lg2 icon-margin"></i>
          <p class="btn-tittle mb0" ng-class="{'wrap-text': language === 'es'}"
            ng-bind="loc.SMARTSHOPPER_HOMECARD_HEADING">
          </p>
        </button>
        <span ng-click="openInfoModal()" ng-bind="loc.SMARTSHOPPER_HOMECARD_LEARN_MORE"
          track-action="{action: 'healthNavSmartShopperInfo', section: analyticConstants.HEALTHNAV_SECTION}"
          class="home_card_link modal-link"></span>
      </div>
      <div class="provider-data-section">
        <hr />
        <div class="data-description">
          <label ng-bind="findDoctorSearchDetails.providerDataUpdate"></label>
        </div>
      </div>
    </div>
  </div>
  <find-doctor-refine-search-modal open-modal-fn-alias="openModal" confirm-fn="confirmModal" modal-info="modalObj">
  </find-doctor-refine-search-modal>
  <smart-shopper-confirm-terms-alert-modal open-modal-fn-alias="openTermsModal" confirm-fn="confirmTermsFunc"
    modal-info="termsModalObj">
  </smart-shopper-confirm-terms-alert-modal>
</div>