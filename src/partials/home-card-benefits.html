<div class="home-card benefits-card">
  <div
    class="home-card-header"
    ng-click="checkLink()"
    track-action="{action: 'homeViewBenefits', section: analyticConstants.HOME_SECTION}"
  >
    <div>
      <h3>
        <i class="fc-circlefill fc-xl fc-underlay white"></i>
        <i class="fc-benefits fc-xl fc-overlay"></i>
      </h3>
    </div>
    <div class="home-card-header-text">
      <p><strong ng-bind="loc.BENEFITS_HOME"></strong></p>
      <p
        ng-bind="getPolicyPlanTitle(selectedPolicy) + ' ' + getPolicyDates(selectedPolicy)"
        class="policy-description"
      ></p>
    </div>
  </div>
  <!-- For non Amisys users -->
  <div
    class="home-card-body"
    ng-if="policy.sourceSystem != 'Amisys' && policySelection.choice != 'DENTAL_ONLY' && policySelection.choice != 'CONTRACEPTIVE_ONLY' && policySelection.choice != 'BBTRX_ONLY' && policySelection.choice != 'VISION_ONLY'"
  >
    <blue-bar-label
      class="benefits-homecard-bluebar"
      ng-bind="loc.HEALTH_BEN"
      ng-if="policySelection.type === 'COMBO'"
    ></blue-bar-label>
    <div ng-if="selectedPolicy.active && benefits.fundsStatusCode != 400">
      <div
        ng-if="benefits.fundData == null || benefits.fundData.length == 0"
        class="funds-error-container"
      >
        <div class="benefit-error" ng-bind="benefits.fundsError"></div>
      </div>
      <div ng-repeat="fund in benefits.fundData">
        <div class="home-card-fund-balance">
          <div
            class="pull-left fund-balance-text"
            ng-if="fund.fundingAccountTypeCode === 'HSA'"
            ng-bind="loc.HSA_BALANCE"
          ></div>
          <div
            class="pull-left fund-balance-text"
            ng-if="fund.fundingAccountTypeCode === 'HRA'"
            ng-bind="loc.HRA_BALANCE"
          ></div>
          <div
            class="pull-left fund-balance-text"
            ng-if="fund.fundingAccountTypeCode === 'FSA'"
            ng-bind="loc.FSA_BALANCE"
          ></div>
          <div
            class="pull-left fund-balance-text"
            ng-if="fund.fundingAccountTypeCode === 'DCRA'"
            ng-bind="loc.DCRA_BALANCE"
          ></div>
          <div
            class="pull-right fund-balance-value"
            ng-bind="fund.fundAmount | currency"
          ></div>
        </div>
      </div>
    </div>

    <div ng-if="benefits.benefitDataEmpty" class="benefits-error-container">
      <!-- error message for benefits not available -->
      <blue-bar-label
        class="benefits-homecard-bluebar"
        ng-bind="loc.HEALTH_BEN"
        ng-if="policySelection.type === 'COMBO'"
      ></blue-bar-label>
      <div class="benefit-error" ng-bind="benefits.BENEFITS_USAGE_ERROR"></div>
    </div>
    <div ng-if="!benefits.benefitDataEmpty ">
      <div class="benefits-heading-text">
        <i class="fc-circle-group benefits-icon"></i>
        <div
          class="family-summary"
          ng-bind="benefits.itemDTO[0].headerText"
        ></div>
        <div
          class="family-progress-text"
          ng-bind="benefits.itemDTO[0].subHeaderText"
        ></div>
      </div>

      <div class="graph-container">
        <div
          class="in-overall-benefit"
          ng-show="benefits.itemDTO[0].graphData.isFullBenefit"
        >
          <div style="text-align:center;">
            <i class="fc-check-only"></i>
            <span ng-bind="benefits.itemDTO[0].graphData.fullBenefit_Label_Top">
            </span>
          </div>
          <div
            style="text-align:center;"
            ng-bind="benefits.itemDTO[0].graphData.fullBenefit_Label_Bottom"
          ></div>
        </div>
        <!--Left side of the graph when member is in full-benefit-->
        <div
          class="graph-left override-padding"
          ng-show="benefits.itemDTO[0].graphData.deductibleMet_inFullBenefit"
        >
          <div
            ng-bind="benefits.itemDTO[0].graphData.deductibleMet_inFullBenefit_Label"
            class="in-full-benefit in-full-benefit-height"
          ></div>
          <i id="fc-check-only" class="fc-check-only in-full-benefit"></i>
          <vertical-bar-graph
            graph-height="{{benefits.itemDTO[0].graphData.deductibleGraph.graphHeight}}"
            graph-values="benefits.itemDTO[0].graphData.deductibleGraph"
          >
          </vertical-bar-graph>
        </div>
        <!--Left side of the graph when member is NOT in full-benefit-->
        <div
          class="graph-left"
          ng-show="!benefits.itemDTO[0].graphData.deductibleMet_inFullBenefit && !benefits.itemDTO[0].graphData.deductibleMet_dontContribute"
        >
          <div
            class="graph-text"
            ng-bind="benefits.itemDTO[0].graphData.leftHeadingLabel"
          ></div>
          <div class="graph-amount">
            {{benefits.itemDTO[0].graphData.deductible | currency:'$': 0}}
          </div>
          <vertical-bar-graph
            graph-height="{{benefits.itemDTO[0].graphData.deductibleGraph.graphHeight}}"
            graph-values="benefits.itemDTO[0].graphData.deductibleGraph"
          >
          </vertical-bar-graph>
          <div
            class="graph-text-bottom"
            ng-bind="benefits.itemDTO[0].graphData.leftBottomLabel"
          ></div>
          <div class="graph-amount">
            {{benefits.itemDTO[0].graphData.deductibleMet.toFixed(2) |
            currency}}
          </div>
        </div>
        <div
          class="graph-left override-padding"
          ng-show="benefits.itemDTO[0].graphData.deductibleMet_dontContribute"
        >
          <div
            ng-bind="benefits.itemDTO[0].graphData.deductibleMet_dontContribute_Label"
            class="in-full-benefit"
          ></div>
          <i id="fc-processed" class="fc-check-only in-full-benefit"></i>
        </div>

        <!--Right side-->
        <div
          class="graph-right unlimited-oop override-padding"
          ng-show="benefits.itemDTO[0].graphData.outOfPocketMet_unlimited"
        >
          <div
            class="graph-text"
            ng-bind="benefits.itemDTO[0].graphData.outOfPocketMet_unlimited_Label_Top"
          ></div>
          <div
            class="graph-amount"
            ng-bind="benefits.itemDTO[0].graphData.outOfPocketMet_unlimited_Value_Top"
          ></div>
          <hr />
          <div
            class="graph-text"
            ng-bind="benefits.itemDTO[0].graphData.outOfPocketMet_unlimited_Label_Bottom"
          ></div>
          <div class="graph-amount">
            {{benefits.itemDTO[0].graphData.outOfPocketMet_unlimited_Value_Bottom
            | currency}}
          </div>
        </div>
        <div
          class="graph-right override-padding"
          ng-show="benefits.itemDTO[0].graphData.outOfPocketMet_inFullBenefit && !benefits.itemDTO[0].graphData.outOfPocketMet_unlimited"
        >
          <div
            ng-bind="benefits.itemDTO[0].graphData.outOfPocketMet_inFullBenefit_Label"
            class="in-full-benefit in-full-benefit-height"
          ></div>
          <i id="fc-processed" class="fc-check-only in-full-benefit"></i>
          <vertical-bar-graph
            graph-height="{{benefits.itemDTO[0].graphData.oopGraph.graphHeight}}"
            graph-values="benefits.itemDTO[0].graphData.oopGraph"
          >
          </vertical-bar-graph>
        </div>
        <div
          class="graph-right"
          ng-show="!benefits.itemDTO[0].graphData.outOfPocketMet_inFullBenefit && !benefits.itemDTO[0].graphData.outOfPocketMet_dontContribute && !benefits.itemDTO[0].graphData.outOfPocketMet_unlimited"
        >
          <div
            class="graph-text"
            ng-bind="benefits.itemDTO[0].graphData.rightHeadingLabel"
          ></div>
          <div class="graph-amount">
            {{benefits.itemDTO[0].graphData.outOfPocketLimit | currency:'$': 0}}
          </div>
          <vertical-bar-graph
            graph-height="{{benefits.itemDTO[0].graphData.oopGraph.graphHeight}}"
            graph-values="benefits.itemDTO[0].graphData.oopGraph"
          >
          </vertical-bar-graph>
          <div
            class="graph-text-bottom"
            ng-bind="benefits.itemDTO[0].graphData.rightBottomLabel"
          ></div>
          <div
            class="graph-amount"
            ng-bind="'$' +benefits.itemDTO[0].graphData.outOfPocketMet.toFixed(2)"
          ></div>
        </div>
        <div
          class="graph-right override-padding"
          ng-show="benefits.itemDTO[0].graphData.outOfPocketMet_dontContribute && !benefits.itemDTO[0].graphData.outOfPocketMet_unlimited"
        >
          <div
            ng-bind="benefits.itemDTO[0].graphData.outOfPocketMet_dontContribute_Label"
            class="in-full-benefit"
          ></div>
          <i id="fc-processed" class="fc-check-only in-full-benefit"></i>
        </div>
      </div>
      <div class="small-padding">
        <button
          class="btn btn-default btn-block"
          ng-bind="loc.VIEW_ALL_BENEFITS"
          ng-click="checkLink()"
          track-action="{action: 'homeViewAllBenefits', section: analyticConstants.HOME_SECTION}"
        ></button>
      </div>
    </div>
    <div>
      <div id="dental_single" ng-if="policySelection.showDental">
        <blue-bar-label
          class="benefits-homecard-bluebar"
          ng-bind="loc.DENTAL_BEN"
        ></blue-bar-label>
        <div class=" home-card-no-secure-messages home-card-no-messages">
          <span ng-bind="loc.INFO_DENTAL_BEN"></span>
        </div>
        <div class="small-padding">
          <button
            class="btn btn-default btn-block"
            ng-click="gotoDentalBenefits(policySelection.dentalSSOLink); $event.stopPropagation();"
            track-action="{action: 'homeViewDentalBenefits', section: analyticConstants.HOME_SECTION}"
          >
            <span ng-bind="loc.VIEW_DENTAL_BEN"></span>
            <i class="fc-external-link light-gray"></i>
          </button>
        </div>
      </div>
      <div id="rx_single" ng-if="policySelection.showRx">
        <blue-bar-label
          class="benefits-homecard-bluebar"
          ng-bind="loc.RX_BEN"
        ></blue-bar-label>
        <div class=" home-card-no-secure-messages home-card-no-messages">
          <span ng-bind="loc.INFO_RX_BEN" ng-if="!benefits.isState"></span>
          <span
            ng-bind="loc.FAQ_RX_BENEFITS_SHP_ANS"
            ng-if="benefits.isState"
          ></span>
        </div>
        <div class="small-padding">
          <button
            class="btn btn-default btn-block"
            ng-click="gotoDrugBenefits(policySelection.rxSSOLinkBenefits); $event.stopPropagation();"
            track-action="{action:'homeViewPrescriptionBenefits', section: analyticConstants.HOME_SECTION}"
          >
            <span ng-bind="loc.VIEW_RX_BEN"></span>
            <i class="fc-external-link light-gray"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
  <div ng-if="!benefits.benefitDataEmpty ">
    <!-- For Amisys (Medicare) users -->
    <div
      class="home-card-body small-padding"
      ng-if="selectedPolicy.sourceSystem == 'Amisys' && selectedPolicy.productInfo[0].benefitOptionGroupTypeCode == 'MED' && selectedPolicy.active == true && policySelection.choice != 'DENTAL_ONLY' && policySelection.choice != 'BBTRX_ONLY' && policySelection.choice != 'VISION_ONLY'"
    >
      <div class="graph-container">
        <div class="medicare-text" ng-bind="benefits.dataText"></div>
      </div>
      <button
        class="btn btn-default btn-block"
        ng-bind="loc.VIEW_BENEFITS"
        ng-click="checkLink()"
        track-action="{action: 'homeViewMedicareBenefits', section: analyticConstants.HOME_SECTION}"
      ></button>
    </div>

    <!-- For Amisys with prescription only users -->
    <div
      class="home-card-body small-padding"
      ng-if="selectedPolicy.sourceSystem == 'Amisys' && selectedPolicy.productInfo[0].benefitOptionGroupTypeCode == 'DRU' && selectedPolicy.active == true && policySelection.choice != 'DENTAL_ONLY' && policySelection.choice != 'BBTRX_ONLY' && policySelection.choice != 'VISION_ONLY'"
    >
      <div class="graph-container">
        <div class="medicare-text" ng-bind="benefits.dataText"></div>
      </div>
      <button
        class="btn btn-default btn-block"
        ng-click="gotoDrugBenefits(policySelection.rxSSOLinkBenefits);"
        track-action="{action: 'homeViewPrescriptionBenefits', section: analyticConstants.HOME_SECTION}"
      >
        <span ng-bind="loc.MED_VIEW_PRESCRIPTION_BENFITS"></span>
        <i class="fc-external-link light-gray"></i>
      </button>
    </div>

    <!-- For prescription only users -->
    <div
      class="home-card-body small-padding no-vertical-padding"
      ng-if="policySelection.choice == 'BBTRX_ONLY'"
    >
      <div class="graph-container">
        <div class="medicare-text no-margin" ng-bind="benefits.dataText"></div>
      </div>
      <button
        class="btn btn-default btn-block"
        ng-click="gotoDrugBenefits(policySelection.rxSSOLinkBenefits);"
        track-action="{action: 'homeViewPrescriptionBenefits', section: analyticConstants.HOME_SECTION}"
      >
        <span ng-bind="loc.MED_VIEW_PRESCRIPTION_BENFITS"></span>
        <i class="fc-external-link"></i>
      </button>
    </div>

    <!-- For contraceptive only users -->
    <div
      class="home-card-body small-padding no-vertical-padding"
      ng-if="policySelection.choice == 'CONTRACEPTIVE_ONLY'"
    >
      <div class="graph-container">
        <div class="benefits-text" ng-bind="benefits.dataText"></div>
      </div>

      <div>
        <div
          class="home_card_link"
          ng-bind="benefits.linkText"
          ng-click="openModal();"
        ></div>
      </div>

      <div class="small-padding very-small-horizontal-padding">
        <button
          class="btn btn-default btn-block"
          ng-bind="loc.BENEFITS_CONTRACEPTIVE_ONLY_HOME_CARD_BUTTON"
          ng-click="checkLink()"
        ></button>
      </div>
    </div>

    <!-- For dental only users -->
    <div
      class="home-card-body small-padding"
      ng-if="policySelection.choice == 'DENTAL_ONLY' || (policySelection.choice == 'DENTAL_ONLY' && selectedPolicy.active == false)"
    >
      <div
        class=" home-card-no-secure-messages home-card-no-messages"
        style="margin-left: -12px;"
      >
        <span ng-bind="loc.INFO_ABOUT_DENTAL_BENEFITS"></span>
      </div>
      <button
        class="btn btn-default btn-block"
        ng-click="gotoDentalBenefits(policySelection.dentalSSOLink)"
        track-action="{action: 'homeViewDentalOnlyBenefits', section: analyticConstants.HOME_SECTION}"
      >
        <span ng-bind="loc.VIEW_DENTAL_BEN"></span>
        <i class="fc-external-link light-gray"></i>
      </button>
    </div>

    <!-- For vision only users -->
    <div
      class="home-card-body small-padding no-vertical-padding"
      ng-if="policySelection.choice == 'VISION_ONLY' || (policySelection.choice == 'VISION_ONLY' && selectedPolicy.active == false)"
    >
      <div
        class="small-margin-bottom home-card-no-secure-messages home-card-no-messages"
        style="margin-left: -12px;"
      >
        <span ng-bind="loc.BLUE2020_BENEFITS_SSO_OUT_MESSAGE"></span>
      </div>
      <button class="btn btn-default btn-block" ng-click="checkLink()">
        <span
          ng-bind="loc.BLUE2020_BENEFITS_BUTTON_VIEW_VISION_BENEFITS"
        ></span>
      </button>
    </div>

    <!-- For Amisys with inactivePolicy -->
    <div
      class="home-card-body small-padding"
      ng-if="selectedPolicy.sourceSystem == 'Amisys' && selectedPolicy.active == false"
    >
      <div class="graph-container">
        <div class="medicare-text" ng-bind="benefits.dataText"></div>
      </div>
      <button
        class="btn btn-default btn-block"
        ng-bind="loc.VIEW_BENEFITS"
        ng-click="checkLink()"
        track-action="{action: 'homeViewInactivePolicyBenefits', section: analyticConstants.HOME_SECTION}"
      ></button>
    </div>
  </div>
</div>
